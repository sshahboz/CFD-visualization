(function(){"use strict";var e={3865:function(e,t,n){var r=n(9026),s=(n(3964),n(429),n(6409),Vue),i=n.n(s),o=function(){var e=this,t=e._self._c;return t("trame-connect",{attrs:{"use-url":"","forward-errors":""}},[t("trame-template",{attrs:{"use-url":""}})],1)},a=[],l=function(){var e=this;e._self._c;return e.ready?e._t("default"):e._e()},c=[],u=(n(560),n(6265),n(3843),n(8730),n(9307),n(2826),n(4043),n(7267),n(6532),n(9543)),h=n(5432),m=n(7534),d=e=>({getArray(t,n=!0){return e.call("viewport.geometry.array.get",[t,n]).then((e=>e.buffer?new Blob([e]):e))},getViewState(t,n=!1){return e.call("viewport.geometry.view.get.state",[t,n])},addViewObserver(t){return e.call("viewport.geometry.view.observer.add",[t])},removeViewObserver(t){return e.call("viewport.geometry.view.observer.remove",[t])},subscribeToViewChange(t){return e.subscribe("viewport.geometry.view.subscription",t)},unsubscribe(t){return e.unsubscribe(t)}}),p=e=>({lifeCycleUpdate(t){return e.call("trame.lifecycle.update",[t])},sendError(t){return e.call("trame.error.client",[t])},getState(){return e.call("trame.state.get",[])},trigger(t,n=[],r={}){return e.call("trame.trigger",[t,n,r])},updateState(t){return e.call("trame.state.update",[t])},subscribeToStateUpdate(t){return e.subscribe("trame.state.topic",t)},subscribeToActions(t){return e.subscribe("trame.actions.topic",t)},unsubscribe(t){return e.unsubscribe(t)}}),f={SyncView:d,Trame:p};m.ZP.setSmartConnectClass(h.ZP);const y={},g={"http:":"ws:","https:":"wss:","ws:":"ws:","wss:":"wss:"},v=["unsubscribe","subscribeToViewChange","subscribeToStateUpdate","subscribeToActions","subscribeToViewChange"];function w(e){const t=(0,r.Z)({},e);if(t.sessionURL){let e=t.sessionURL.toLowerCase();const n=window.location;if(e.includes("use_")){const t=new URL(e);t.protocol=g[n.protocol],e=t.toString()}const r={use_hostname:n.hostname,use_host:n.host};for(const[t,s]of Object.entries(r))e=e.replaceAll(t,s);t.sessionURL=e}t.application=document.querySelector("html").dataset.appName||t.application;const n=document.querySelector("html").dataset.sessionManagerUrl||t.sessionManagerURL;return n&&(t.sessionManagerURL=n),t.useUrl?(0,r.Z)((0,r.Z)({},t),u.Z.extractURLParameters()):t}function b(){return m.ZP.newInstance({protocols:f,configDecorator:w,notBusyList:v})}function C(e){var t,n;let r=null===(t=y[e])||void 0===t?void 0:t.client;if(!r){r=b();const a=[],l={type:"created",message:"Client connected..."};function c(t){y[e].status=t}y[e]={client:r,status:l,subscriptions:a},a.push(r.onConnectionError((e=>{var t;c({type:"Connection error",message:null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.error})}))),a.push(r.onConnectionClose((e=>{var t;c({type:"Connection closed",message:null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.error})})))}const s=new URL(window.location).searchParams,i=["sessionURL","sessionManagerURL","secret","application","remove"].concat((null===(n=s.get("remove"))||void 0===n?void 0:n.split(","))||[]);i.forEach((e=>s.delete(e)));const o=`${window.location.pathname}${s.size?"?":""}${s.toString()}${window.location.hash}`;return window.history.replaceState({},document.title,o),r}function _(e){y[e]=null}function T(e){return y[e].status}var S={getClient:C,resetClient:_,getStatus:T,configDecorator:w},$=(n(8324),n(7117));n(5137);const x={};function O(e,t){return e.priority-t.priority}function R(e){x.addAttachement=e}const L={priority:0,async decorate(e){if(null===e||void 0===e)return e;if(e.constructor&&e.constructor===File){const{name:t,lastModified:n,size:r,type:s}=e,i=await new Promise((t=>{const n=new FileReader;n.addEventListener("loadend",(()=>{t(n.result)})),n.readAsArrayBuffer(e)})),o=new DataView(i);return{name:t,lastModified:n,size:r,type:s,content:o,_filter:["content"]}}return e}},U={priority:0,async decorate(e){if(null===e||void 0===e)return e;if("string"===typeof e)return e;if(e.constructor&&e.constructor===FileList||e.length){const t=[];for(let n=0;n<e.length;n++)t.push(await L.decorate(e[n]));return t}return e}},A={priority:0,async decorate(e){if(null===e||void 0===e)return e;if("string"===typeof e)return e;if(e.constructor&&e.constructor===Object){const t={},n=Object.keys(e);for(let r=0;r<n.length;r++){const s=n[r];t[s]=e[s],t[s]=await U.decorate(t[s]),t[s]=await L.decorate(t[s])}return t}return e}},j=[L,U,A];function k(e){j.push(e),j.sort(O)}async function N(e){let t=e;for(let n=0;n<j.length;n++){if(null===t||void 0===t)return t;t=await j[n].decorate(t)}return t}const E=["type","key","keyCode","controlKey","altKey","shiftKey","position","spinX","spinY","pixelX","pixelY"];function V(e){const t={};for(let n=0;n<E.length;n++){const r=E[n];r in e&&(t[r]=e[r])}return t}var B={event:V};n(7389);function I(e,t=[],n=1e3,r=2){if(null===e)return null;for(let s=0;s<t.length;s++){const i=Array.isArray(n)?n[s]:n,o=t[s];if(!(e>i))return`${e.toFixed(r)} ${o}`;e/=i}return`${e.toFixed(r)} ${n[n.length-1]}`}function Z(e,t=2){return I(e,["B","KB","MB","GB","TB","PB"],1024,t)}var M={number:I,bytes:Z};async function P(e,t,n="application/octet-stream"){const r=await Promise.resolve(t),s=new Blob([r],{type:n}),i=URL.createObjectURL(s),o=document.createElement("a");o.setAttribute("href",i),o.setAttribute("download",e),document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout((()=>URL.revokeObjectURL(i)),1e3)}function D(e,t=window){let n=t;const r=e.split(".");for(let s=0;s<r.length;s++)n=n[r[s]];return n}function H(e){try{return JSON.stringify(e),e}catch(r){}const t={},n=Object.keys(e);for(let s=0;s<n.length;s++){const i=n[s],o=e[i];if(Array.isArray(o))t[i]=o.map(H);else try{JSON.stringify(o),t[i]=o}catch(r){continue}}return t}function K(e,t,n){const r={id:e},s=t?`${t}: `:"";return Array.isArray(n)?(r.name=`${s}[]`,n.length&&(r.children=[]),r):null!==n&&n?"function"===typeof n?(r.name=`${s}function`,r):"object"===typeof n?(r.name=`${s}{}`,Object.keys(n).length&&(r.children=[]),r):(r.name=`${s}${n}`,r):(r.name=`${s}${n}`,r)}function J(e,t,n,r){const s=K(t,n,r);e.push(s),s.children&&z(t,s.children,r)}function z(e,t,n){if(Array.isArray(n)){const r=null;for(let s=0;s<n.length;s++)J(t,`${e}_${s}`,r,n[s])}else{const r=Object.keys(n);for(let s=0;s<r.length;s++){const i=r[s];J(t,`${e}_${s}`,i,n[i])}}}function q(e){const t=[];return z("",t,e),t}var F={download:P,get:D,safe:H,tree:q,vtk:B,fmt:M};const G={};window.trame||(window.trame={}),window.trame.utils||(window.trame.utils=F),window.trame.state||(window.trame.state=G);var W=[];function X(e){return new Promise((function(t,n){if(-1===W.indexOf(e)){W.push(e);var r=document.createElement("script");r.type="text/javascript",r.src=e,r.onload=t,r.onerror=n,document.body.appendChild(r)}else t(!1)}))}function Y(e){return new Promise((function(t,n){if(-1===W.indexOf(e)){W.push(e);var r=document.createElement("script");r.type="module",r.src=e,r.onload=t,r.onerror=n,document.body.appendChild(r)}else t(!1)}))}function Q(e){return new Promise((function(t,n){if(-1===W.indexOf(e)){W.push(e);var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onload=t,r.onerror=n,document.head.appendChild(r)}else t(!1)}))}function ee(e){const t={tts:0};return e.forEach((e=>{t[e]=0})),new(i())({data:t})}function te(e,t){function n(e){for(let n=0;n<e.length;n++)t[e[n]]++}return e.$on("stateChange",n),()=>{e.$off("stateChange",n)}}function ne(e,t,n){const r={};return t.forEach((t=>{r[t]={get(){return n[t],e.state.get(t)},set(n){e.state.set(t,n)}}})),r}const re={},se={};async function ie(e,t){for(let n=0;n<e.length;n++)await t(e[n])}function oe(e,t){const n=[],r={};for(let o=0;o<e.length;o++){let t=n,s=e[o];if(Array.isArray(s)){const e=s[1].serial;e&&(r[e]||(r[e]=[]),t=r[e]),[s]=s}t.push(s)}const s=n.map(t),i=Object.values(r);for(let o=0;o<i.length;o++)s.push(ie(i[o],t));return Promise.all(s)}async function ae(e,t,n=[]){const r=e=>!n.includes(e);e.includes("trame__styles")&&await oe(t.trame__styles.filter(r),Q),e.includes("trame__scripts")&&await oe(t.trame__scripts.filter(r),X),e.includes("trame__module_scripts")&&await oe(t.trame__module_scripts.filter(r),Y),e.includes("trame__vue_use")&&t.trame__vue_use.forEach((e=>{let t=e,r={};Array.isArray(e)&&([t,r]=e);let s=F.get(t);s?se[t]||n.includes(t)||(se[t]=!0,s.default&&(s=s.default),console.info(`Vue.use(${t}, ${JSON.stringify(r)}) - ${!!s} - install(${!!s.install})`),s.install?(i().use(s,r),s.getOptions&&Object.assign(re,s.getOptions())):i().use({install:s},r)):console.error(`Lookup error: Vue.use(${t}, ${JSON.stringify(r)})`)})),e.includes("trame__favicon")&&t.trame__favicon&&(document.querySelector("link[rel=icon]").href=t.trame__favicon),e.includes("trame__title")&&t.trame__title&&(document.title=t.trame__title)}class le{constructor(e,t=null,n=[]){this.name="Default trame application",this.vueInstance=e,this.client=(null===e||void 0===e?void 0:e.client)||t,this.exclude=(null===e||void 0===e?void 0:e.exclude)||n,this.subscriptions=[],this.state={},this.keyTS={},this.ts=0,this.trameTemplateTS=0,this.trameTemplate={template:"<div>Too early for trame template</div>"},this.dirtyKeys=new Set,this.registerDecorator=k;const r=async e=>{const t=[],n=Object.keys(e);for(let o=0;o<n.length;o++){var r;let s=!0;const i=n[o],a=e[i];if(null!==a&&void 0!==a&&null!==(r=a._filter)&&void 0!==r&&r.length){s=!1;const e=this.state[i],t=Object.keys(a);for(let n=0;!s&&n<t.length;n++){const r=t[n];"_"!==r[0]&&(void 0!==e&&e[r]===a[r]||(s=!0))}}s&&(t.push(i),this.state[i]=a)}this.ts+=1;let s=0;for(let o=0;o<t.length;o++){const e=t[o];void 0===this.keyTS[e]&&s++,this.keyTS[e]=this.ts}var i;if((await ae(t,this.state,this.exclude),s&&(this.updateTrameTemplate(),this.vueInstance&&this.vueInstance.$emit("trameTemplateChange",this.trameTemplateTS)),this.vueInstance)&&(this.vueInstance.$emit("stateChange",t),this.vueInstance.$router&&null!==e&&void 0!==e&&null!==(i=e.trame__routes)&&void 0!==i&&i.length)){const t=this.vueInstance.$router;e.trame__routes.forEach((e=>{t.addRoute(e)}))}};this.subscriptions.push(this.client.getRemote().Trame.subscribeToStateUpdate((([e])=>r(e)))),this.client.getRemote().Trame.getState().then((({state:t,name:n})=>{this.name=n,r(t),e&&(e.ready=!0)})),this._updateFromServer=r}updateTrameTemplate(){if(!this.vueInstance)return;this.trameTemplateTS+=1;const e=Object.keys(this.state),t=ee(e),n=te(this.vueInstance,t),s=ne(this.vueInstance,e,t);let i=0;this.trameTemplate={name:"TrameTemplateInternal",inject:["trame"],props:{templateName:{type:String,default:"main"}},components:{VRuntimeTemplate:$.Z},computed:(0,r.Z)((0,r.Z)({},s),{},{contentTemplate(){const e=`trame__template_${this.templateName}`;return this[e]||`<div>No state variable for ${e} with the following state.<br><pre>${JSON.stringify(this.trame.state.get(),null,2)}</pre></div>`},tts(){return t.tts},utils(){return F}}),watch:{contentTemplate(){setTimeout((()=>t.tts+=1),10)}},methods:{set(e,t){return this.trame.state.set(e,t)},get(e=null){return this.trame.state.get(e)},setAll(e){return this.trame.state.update(e)},flushState(...e){return this.trame.state.flush(...e)},registerDecorator(...e){return this.trame.state.registerDecorator(...e)},async trigger(e,t=[],n={}){let r=[];const s={};if(t){const e=t.map((e=>N(e)));r=await Promise.all(e)}if(n){const e=[],t=[];Object.entries(n).forEach((n=>{e.push(n[0]),t.push(N(n[1]))}));const r=await Promise.all(t);for(let n=0;n<e.length;n++)s[e[n]]=r[n]}return await this.trame.client.getRemote().Trame.trigger(e,r,s)},getRef(e){const{trameTemplateRootRef:t}=this.$refs;return t.$refs&&t.$refs[e]?t.$refs[e]:t.$children[0].$refs[e]},execAction(e){const{ref:t,type:n}=e,r=this.getRef(t);if(r&&"method"===n){const{method:t,args:n}=e;r[t](...n)}if(r&&"property"===n){const{property:t,value:n}=e;r[t]=n}}},created(){i++,this.onActions=([e])=>{for(let t=0;t<e.length;t++)this.execAction(e[t])},this.clientSub=this.trame.client.getRemote().Trame.subscribeToActions(this.onActions),G.set=(e,t)=>this.set(e,t),G.get=e=>this.get(e),G.setAll=e=>this.setAll(e),G.flushState=(...e)=>this.flushState(...e),G.registerDecorator=(...e)=>this.registerDecorator(...e),G.trigger=async(e,t=[],n={})=>this.trigger(e,t,n)},beforeDestroy(){i--,0===i&&n(),this.trame.client.getRemote().Trame.unsubscribe(this.clientSub)},template:'<v-runtime-template ref="trameTemplateRootRef" :template="contentTemplate" />'}}delete(){while(this.subscriptions.length)this.client.getRemote().Trame.unsubscribe(this.subscriptions.pop())}get(e){return void 0===e?this.state:this.state[e]}getTimeStamp(e){return this.keyTS[e]||0}async set(e,t){this.state[e]!==t&&(this.ts+=1,this.state[e]=t,this.keyTS[e]=this.ts,this.dirty(e),await this.flush())}async update(e){this.ts+=1;for(const[t,n]of Object.entries(e))this.state[t]!==n&&(this.state[t]=n,this.keyTS[t]=this.ts,this.dirty(t));await this.flush()}canDirty(e){return!this.state.trame__client_only.includes(e)}dirty(...e){e.forEach((e=>{this.canDirty(e)&&this.dirtyKeys.add(e),this.vueInstance&&this.vueInstance.$emit("stateChange",[e])}))}async flush(...e){if(e.length&&e.forEach((e=>{Array.isArray(e)?this.dirty(...e):this.dirty(e)})),this.dirtyKeys.size&&!this.client.isBusy()){const e=[],t=[];this.dirtyKeys.forEach((n=>{e.push(N(this.state[n])),t.push(n)})),this.dirtyKeys.clear();const n=await Promise.all(e),r=t.map(((e,t)=>({key:e,value:n[t]})));await this.client.getRemote().Trame.updateState(r),this.dirtyKeys.size&&this.flush()}this.vueInstance&&!this.vueInstance.connected&&this._updateFromServer(this.state)}}var ce={name:"TrameConnect",props:{name:{type:String,default:"TrameConnect"},config:{type:Object,default:()=>({application:"trame"})},exclude:{type:Array,default:()=>[]},useUrl:{type:Boolean,default:!1},forwardErrors:{type:Boolean,default:!1}},data(){return{ready:!1,connected:!1,busy:1,status:{type:"created",message:"Connecting..."}}},async created(){await this.connect()},beforeDestroy(){this.client.getRemote().Trame.lifeCycleUpdate("client_unmounted");while(this.subscriptions.length)this.subscriptions.pop().unsubscribe();this.state&&(this.state.delete(),this.state=null)},methods:{reportError(e="Something unexpected happened..."){var t,n;let r="trame__template_main";this.useUrl&&u.Z.extractURLParameters().ui&&(r=`trame__template_${u.Z.extractURLParameters().ui}`),null!==this&&void 0!==this&&null!==(t=this.client)&&void 0!==t&&null!==(n=t.getConfig())&&void 0!==n&&n.reconnect?this.state.set(r,`<trame-reconnect message="${e}"/>`):this.state.set(r,`<trame-loading message="${e}"/>`)},async connect(){if(!this.connected){if(this.client){this.previousConfig=this.client.getConfig();while(this.subscriptions.length)this.subscriptions.pop().unsubscribe();this.state&&(this.state.delete(),this.state=null),S.resetClient(this.name)}if(this.subscriptions=[],this.client=S.getClient(this.name),this.subscriptions.push(this.client.onBusyChange((e=>{const t=!e!==!this.busy;this.busy=e,t&&this.state&&this.state.set("trame__busy",e),0===e&&this.state.flush(),t&&this.$emit("busyChange",e)}))),this.subscriptions.push(this.client.onConnectionError((e=>{var t,n;this.connected=!1,this.status={type:"Connection error",message:null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.error},this.reportError((null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.error)||"Connection error"),this.$emit("statusChange",this.status)}))),this.subscriptions.push(this.client.onConnectionClose((e=>{var t,n;this.connected=!1,this.status={type:"Connection closed",message:null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.error},this.reportError((null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.error)||"Connection closed"),this.$emit("statusChange",this.status)}))),this.client.isConnected())this.status=S.getStatus(this.name),this.$emit("statusChange",this.status);else{const e=this.previousConfig||S.configDecorator((0,r.Z)((0,r.Z)({},this.config),{},{useUrl:this.useUrl}));await this.client.connect(e),this.lastConfig=this.client.getConfig(),R(this.client.getConnection().getSession().addAttachment),this.status={type:"Connected"}}if(this.connected=this.client.isConnected(),this.busy=this.client.isBusy(),this.$emit("statusChange",this.status),this.connected&&(this.state=new le(this)),this.client.getRemote().Trame.lifeCycleUpdate("client_connected"),window.addEventListener("beforeunload",(()=>this.client.getRemote().Trame.lifeCycleUpdate("client_exited"))),this.forwardErrors){const e=console.error;console.error=(...t)=>{try{this.client.getRemote().Trame.sendError(t.join(" "))}catch(n){e(n)}finally{e(...t)}},window.addEventListener("error",(e=>{console.error(`${e.type}: ${e.message}`)}))}}},async trigger(e,t=[],n={}){let r=[];const s={};if(t){const e=t.map((e=>N(e)));r=await Promise.all(e)}if(n){const e=[],t=[];Object.entries(n).forEach((n=>{e.push(n[0]),t.push(N(n[1]))}));const r=await Promise.all(t);for(let n=0;n<e.length;n++)s[e[n]]=r[n]}return await this.client.getRemote().Trame.trigger(e,r,s)}},provide(){return{trame:this}}},ue=ce,he=n(1001),me=(0,he.Z)(ue,l,c,!1,null,null,null),de=me.exports,pe=function(){var e=this,t=e._self._c;return t("trame-template-internal",{key:e.trameTemplateTS,attrs:{templateName:e.tName}})},fe=[],ye={name:"TrameServerTemplate",inject:["trame"],props:{templateName:{type:String,default:"main"},urlKey:{type:String,default:"ui"},useUrl:{type:Boolean,default:!1}},data(){return{trameTemplateTS:0}},computed:{tName(){return this.useUrl&&u.Z.extractURLParameters()[this.urlKey]?u.Z.extractURLParameters()[this.urlKey]:this.templateName}},created(){this.onNewTemplate=()=>{this.$options.components.trameTemplateInternal=this.trame.state.trameTemplate,this.trameTemplateTS=this.trame.state.trameTemplateTS},this.trame.$on("trameTemplateChange",this.onNewTemplate),this.onNewTemplate()},beforeDestroy(){this.trame.$off("trameTemplateChange",this.onNewTemplate)}},ge=ye,ve=(0,he.Z)(ge,pe,fe,!1,null,null,null),we=ve.exports,be={name:"App",components:{TrameConnect:de,TrameServerTemplate:we}},Ce=be,_e=(0,he.Z)(Ce,o,a,!1,null,null,null),Te=_e.exports,Se=function(){var e=this,t=e._self._c;return t("div",{class:e.$style.container},[t("div",{class:e.$style.loader}),t("div",{class:e.$style.message},[e._v(" "+e._s(e.message)+" ")])])},$e=[],xe={name:"Loading",props:{message:{type:String,default:"Loading..."}}},Oe=xe,Re={container:"style_container_VCsHx",loader:"style_loader_CNsNi",spin:"style_spin_BAaPb",message:"style_message_rmggO"};function Le(e){this["$style"]=Re.locals||Re}var Ue=(0,he.Z)(Oe,Se,$e,!1,Le,null,null),Ae=Ue.exports,je=function(){var e=this,t=e._self._c;return t("div",{class:e.$style.container},[t("div",{class:e.$style.center},[t("div",{class:e.$style.button,on:{click:e.reconnect}},[t("svg",{staticStyle:{width:"24px"},attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M4,1C2.89,1 2,1.89 2,3V7C2,8.11 2.89,9 4,9H1V11H13V9H10C11.11,9 12,8.11 12,7V3C12,1.89 11.11,1 10,1H4M4,3H10V7H4V3M14,13C12.89,13 12,13.89 12,15V19C12,20.11 12.89,21 14,21H11V23H23V21H20C21.11,21 22,20.11 22,19V15C22,13.89 21.11,13 20,13H14M3.88,13.46L2.46,14.88L4.59,17L2.46,19.12L3.88,20.54L6,18.41L8.12,20.54L9.54,19.12L7.41,17L9.54,14.88L8.12,13.46L6,15.59L3.88,13.46M14,15H20V19H14V15Z"}})]),e._v(" "+e._s(e.message)+" ")])])])},ke=[],Ne={name:"Reconnect",props:{message:{type:String,default:"Click to reconnect..."},maxRetry:{type:Number,default:10},delay:{type:Number,default:500}},methods:{async reconnect(){await this.trame.connect()},resetRetry(){this.interval&&(clearInterval(this.interval),this.interval=null)}},mounted(){var e,t,n;this.retryCount=0;const r=null===(e=this.trame)||void 0===e||null===(t=e.client)||void 0===t||null===(n=t.getConfig())||void 0===n?void 0:n.reconnect;r&&(console.log("reconnect",r),"auto"===r&&(this.interval=setInterval((()=>{this.retryCount++<this.maxRetry?this.reconnect():this.resetRetry()}),this.delay)))},beforeDestroy(){this.resetRetry()},inject:["trame"]},Ee=Ne,Ve={container:"style_container_n4xKQ",center:"style_center_xzh58",button:"style_button_kGhdk"};function Be(e){this["$style"]=Ve.locals||Ve}var Ie=(0,he.Z)(Ee,je,ke,!1,Be,null,null),Ze=Ie.exports,Me=function(){var e=this;e._self._c;return e._t("default",null,null,e.state)},Pe=[];function De(...e){const t={};for(let n=0;n<e.length;n++)t[e[n]]=null;return t}function He(e,t,...n){return r=>{const{state:s}=e,i=new Set(r);for(let e=0;e<n.length;e++){const r=n[e];i.has(r)&&(t[r]=s.get(r))}}}var Ke={inject:["trame"],name:"TrameStateResolver",props:{names:{type:Array,default:()=>[]}},data(){return De(...this.names)},computed:{state(){const e={trame:this.trame,set:(...e)=>this.trame.state.set(...e)};for(let t=0;t<this.names.length;t++){const n=this.names[t];e[n]=this[n]}return e}},created(){this.onStateChange=He(this.trame,this,...this.names),this.trame.$on("stateChange",this.onStateChange),this.onStateChange(this.names)},beforeDestroy(){this.trame.$off("stateChange",this.onStateChange)},provide(){return{state:this}}},Je=Ke,ze=(0,he.Z)(Je,Me,Pe,!1,null,null,null),qe=ze.exports;let Fe=1;function Ge(){return"trame_style_elem_"+Fe++}var We,Xe,Ye={name:"TrameStyle",props:{css:{type:String,default:""}},watch:{css(e){this.updateStyle(e)}},created(){this.elemId=Ge(),this.updateStyle(this.css)},beforeDestroy(){this.removeStyle()},methods:{updateStyle(e){let t=document.querySelector(`#${this.elemId}`);e?(t||(t=document.createElement("style"),t.id=this.elemId,document.head.appendChild(t)),t.innerHTML=e):this.removeStyle()},removeStyle(){const e=document.querySelector(`#${this.elemId}`);e&&e.parentNode.removeChild(e)}}},Qe=Ye,et=(0,he.Z)(Qe,We,Xe,!1,null,null,null),tt=et.exports;const{unref:nt}=window.Vue;let rt=1;function st(){return"trame_script_elem_"+rt++}var it={props:{script:{type:String,default:""},module:{type:Boolean,default:!1}},watch:{script(e){this.updateContent(e)}},created(){this.elemId=st(),this.updateContent(this.script)},beforeUnmount(){this.removeScript()},methods:{updateContent(e){e=nt(e);let t=document.querySelector(`#${this.elemId}`);e?(t||(t=document.createElement("script"),t.id=this.elemId,t.type=this.module?"module":"text/javascript",document.head.appendChild(t)),t.innerHTML=e):this.removeScript()},removeScript(){const e=document.querySelector(`#${this.elemId}`);e&&e.parentNode.removeChild(e)}}};const{inject:ot,reactive:at,onBeforeMount:lt,onBeforeUnmount:ct,watch:ut}=window.Vue;var ht={props:["name"],setup(e){const t=ot("trame"),n=at({});let r=null,s=null;function i(){console.log("pushChange"),s=JSON.stringify(n),s!==r&&t.state.set(e.name,JSON.parse(s))}function o(){console.log("fetchValue"),r=JSON.stringify(t.state.get(e.name)),r!==s&&Object.assign(n,JSON.parse(r))}function a(t){t.includes(e.name)&&o()}return lt((()=>{t.$on("stateChange",a),o()})),ct((()=>{t.$off("stateChange",a)})),ut(n,i),{value:n}},template:'<slot :value="value"></slot>'},mt={name:"TrameExec",props:["event"],methods:{exec(e){void 0===e?this.$emit("exec",this.event):this.$emit("exec",e)}}};n(2176),n(7961);const{inject:dt,ref:pt,onBeforeMount:ft,onBeforeUnmount:yt,watch:gt}=window.Vue;var vt={props:["name"],setup(e){const t=dt("trame"),n=pt(null),r=pt(null);function s(n,r){const s=JSON.parse(JSON.stringify(t.state.get(e.name)));let i=s;const o=String(n).split(".");for(let e=0;e<o.length-1;e++)i=i[o[e]];i[o.at(-1)]=r,t.state.set(e.name,s)}function i(n){t.state.set(e.name,n)}function o(){const s=t.state.get(e.name);r.value!==e.name&&(r.value=e.name),s!==n.value&&(n.value=s)}return gt((()=>e.name),o),ft((()=>{t.$on("stateChange",o),o()})),yt((()=>{t.$off("stateChange",o)})),{computedValue:n,computedName:r,updateNested:s,update:i}},template:'<slot :keyName="computedName" :update="update" :updateNested="updateNested" :value="computedValue"></slot>'};const{watch:wt,nextTick:bt}=window.Vue;var Ct={props:{value:{type:String},immediate:{type:Boolean,default:!1},triggerChangeOnCreate:{type:Boolean,default:!1}},emits:["change"],setup(e,{emit:t}){wt((()=>e.value),(n=>{e.immediate?t("change",n):bt((()=>{t("change",n)}))})),e.triggerChangeOnCreate&&t("change",e.value)}};const{onMounted:_t,onBeforeUnmount:Tt}=window.Vue;var St={emits:["mounted","created","beforeDestroy","beforeUnmount","exit"],setup(e,{emit:t,expose:n}){function r(e,n){t(e,n)}return _t((()=>t("mounted"))),Tt((()=>{t("beforeDestroy"),t("beforeUnmount")})),n({emit:r}),window.addEventListener("beforeunload",(()=>{t("exit")})),t("created"),{emit:r}}};const{onMounted:$t,onUpdated:xt,onUnmounted:Ot,onBeforeMount:Rt,onBeforeUpdate:Lt,onBeforeUnmount:Ut}=window.Vue;function At(e){e()}const jt={created:At,beforeMount:Rt,mounted:$t,beforeUpdate:Lt,updated:xt,beforeDestroy:Ut,destroyed:Ot};var kt={props:{name:{type:String,default:"LifeCycleMonitor"},type:{type:String,default:"log"},value:{type:String,default:"value"},events:{type:Array,default:()=>["created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed"]}},emits:Object.keys(jt),setup(e,{emit:t}){for(let n=0;n<e.events.length;n++){const r=e.events[n],s=jt[r];s((()=>{"emit"===e.type?t(r,{name:e.name,value:e.value}):console[e.type](e.name,r,e.value)}))}}};const{inject:Nt,ref:Et,onMounted:Vt,onBeforeUnmount:Bt}=window.Vue;var It={props:{name:{type:String}},emits:["change"],setup(e,{emit:t}){const n=Nt("trame"),r=Et(null);function s(){const{x:s,y:i,width:o,height:a}=r.value.getBoundingClientRect(),l={x:s,y:i,width:o,height:a},c=window.devicePixelRatio,u=96*c,h={size:l,pixelRatio:c,dpi:u};e.name&&(h.name=e.name),n&&n.state.set(e.name,h),t("change",h)}const i=new ResizeObserver(s);return Vt((()=>{i.observe(r.value)})),Bt((()=>{i.unobserve(r.value)})),{elem:r,resize:s}},template:'<div ref="elem" style="overflow: hidden; position: relative; width: 100%; height: 100%; margin: 0; padding: 0;"><slot></slot></div>'},Zt={TrameApp:Te,TrameConnect:de,TrameLoading:Ae,TrameReconnect:Ze,TrameTemplate:we,TrameStateResolver:qe,TrameScript:it,TrameStyle:tt,TrameDeepReactive:ht,TrameExec:mt,TrameGetter:vt,TrameClientStateChange:Ct,TrameClientTriggers:St,TrameLifeCycleMonitor:kt,TrameSizeObserver:It},Mt={install(e){Object.keys(Zt).forEach((t=>{e.component(t,Zt[t])}))}};const Pt="TrameConnect";function Dt(){const e=S.getStatus(Pt),t=document.querySelector(".trame__message");t?t.innerHTML=e.message||e.type:console.error("WsError",e.message||e.type)}async function Ht(e){try{var t,n,s;null!==(t=window)&&void 0!==t&&null!==(n=t.parent)&&void 0!==n&&null!==(s=n.trameJupyter)&&void 0!==s&&s.init&&(window.WSLINK=window.parent.trameJupyter.init(window))}catch(l){}e.use(Mt);const i=S.configDecorator({application:"trame",useUrl:!0}),o=S.getClient(Pt);try{await o.connect(i)}catch(l){return void Dt()}o.onConnectionError(Dt),o.onConnectionClose(Dt),R(o.getConnection().getSession().addAttachment);const{state:a}=await o.getRemote().Trame.getState();await ae(Object.keys(a),a),new e((0,r.Z)((0,r.Z)({},re),{},{render:e=>e(Te)})).$mount("#app")}u.Z.extractURLParameters().enableSharedArrayBufferServiceWorker&&X("coi-serviceworker.min.js"),Ht(i())}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,r,s,i){if(!r){var o=1/0;for(u=0;u<e.length;u++){r=e[u][0],s=e[u][1],i=e[u][2];for(var a=!0,l=0;l<r.length;l++)(!1&i||o>=i)&&Object.keys(n.O).every((function(e){return n.O[e](r[l])}))?r.splice(l--,1):(a=!1,i<o&&(o=i));if(a){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[r,s,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,i,o=r[0],a=r[1],l=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(s in a)n.o(a,s)&&(n.m[s]=a[s]);if(l)var u=l(n)}for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},r=self["webpackChunktrame_app_vue2"]=self["webpackChunktrame_app_vue2"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(3865)}));r=n.O(r)})();
//# sourceMappingURL=app.9201d5ad.js.map